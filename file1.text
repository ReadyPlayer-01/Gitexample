some implementation
some implementation changes from edit
